# ROIS

ROISは全く新しいお絵かき掲示板スクリプトです。  
Rapid Oekaki Image System で「ROIS」です。

[PaintBBS NEO](https://github.com/funige/neo/)

## 概要

POTI-board改で使用しているテンプレートエンジン「htmltemplate.inc」は老朽化して今後が危ない…  
ということでなんか新しいテンプレートエンジンはないか探したところ、

[Skinny](http://skinny.sx68.net/) → [POTI-board EVO](https://github.com/satopian/POTI-board_EVO)  
↓  
[smarty](https://www.smarty.net/) → [noe](https://github.com/sakots/noe-board)  
↓  
重いからTwigにしたい…（今後）  
↓  
BladeのほうがTwigより速いらしい！？

という経緯です。

## 設置方法

- パスワードその他を設定  
- アップロード
- OK！ index.phpにアクセスしてください。

## 注意

- まだいわゆるアルファ版です。テーマ等仕様がころころ変わる可能性があります。
- noeとデータベースの互換性はありますが、テーマの互換性はありません。

## サンプルとサポート

[このお絵かき掲示板はSQLiteとさらにBladeを（以下略](https://dev.oekakibbs.net/bbs/rois/)

## 同梱のパレットについて

`p_PCCS.txt`(PCCS:日本色研配色体系パレット)は、[色彩とイメージの情報サイト IROUE](https://tee-room.info/color/database.html) を参考に、`p_munsellHVC.txt`(マンセルHV/Cパレット)は、[マンセル表色系とRGB値](http://k-ichikawa.blog.enjoy.jp/etc/HP/js/Munsell/MSL2RGB0.html) を参照して作成いたしました。

再配布等自由にしていただいて構いません。ただの文字列なので著作権の主張はしませんが、書くのにそれなりの苦労はしましたので、再配布の際はどこかに私の名前を書いていただければと思います。

## 履歴

### [2021/08/30] v0.99.12

**このバージョンでバグが見つからなければ、次はv1.0.0とします。**

- レス画面のコメントの並びが逆順になっていたの修正
- レスが編集できなかったの修正
- 検索がおかしかったの修正
- オートリンクもおかしかったので修正
- 画像描画時間をユーザーコードから算出するようにした
- ついでに使用ツールもユーザーコードを拡張して記録するようにした

### [2021/08/29] v0.99.11

- レス画面でオートリンクとハッシュタグリンクが機能していないの修正
- 引用レスで色が変わるのが機能していなかったの修正
- 絵を描くのに使ったツールを頑張って記録するようにした
  - データベースを拡大しています。これ以上形式が変わらないようにせっかくなので4項目予備として増やしておきました。

### [2021/08/29] v0.99.10

- レス順が逆になっていたの修正
- ハッシュタグリンク、URLオートリンクが機能していなかったの修正
- 検索窓のSQL脆弱性を修正
- themes
  - カタログモードの記述ミス修正

### [2021/08/28] v0.99.9

- configでの最大スレッド数を超えたときの処理ができるように修正
- テーマの画像表示サイズ修正

### [2021/08/21] v0.99.8

- configでの最大スレッド数を超えたときの処理が、ファイルの削除しかできないので諦めた。
- それに伴いスレが消えるときにレスも全部消えるようにしたので、configでの最大レス数設定が無意味に
- 各テーマの「書式がXHTMLのものか」の定義が消えていたの修正
- ChikenPaintがちょっと使いやすくなった。
- パレット切り替えのクッキーの処理が正しく行われていないのをこんどこそ修正

### [2021/08/19] v0.99.7b

- themes
  - パレット切り替えのクッキーの処理が正しく行われていないの修正

### [2021/08/19] v0.99.7

- ChickenPaintを最新ビルドに更新
- 2021/08/15のテーマを同梱

### [2021/08/15] themes

- 絵を描くのに集中できるよう、NEOのキャンバス周りの彩度を下げた
- ついでに配色パターンまた追加

### [2021/08/15] v0.99.6

- palette選択をCookieに保存できるようにした
- コード整理

### [2021/08/15] v0.99.5

- 続きから描けないほかデータベース周りのエラー修正
- Cookie周り修正

### [2021/08/15] v0.99.4

- 検索でエラーが出るようになっていたの修正

### [2021/08/15] v0.99.3

- ChickenPaintのレイヤー情報ファイルがあると、動画へのリンクが出るのを修正
- パレットのファイルの変数が未定義だったのを修正
- ゆるやかな比較で true と比較する意味が無い箇所を整理
- 続きから描くとき、レイヤー情報がある場合画像からでもそのツールで続きから描くように変更
- Cookie関連のバグ修正
- データベース関連の脆弱性対応

### [2021/08/13] v0.99.2

- 続きから描いた画像のファイル名と動画名を新しく変更(キャッシュが表示される、キャッシュの続きから描くことがあるため)
- 続きから描いた時の描画時間がおかしくなるの修正
- ChickenPaint関連の不具合修正
- 各themeのcssにスレッドタイトルの文字色設定追加

### [2021/08/12] theme

- カタログモード等で追加のお知らせがうまく表示されていないの修正
- monoredにSQL色追加
- SVGアイコンの読み込み方法及びアイコン微修正

### [2021/08/12] v0.99.1

- phpスクリプト内の、Bladeに渡す配列の書式変更(by さとぴあ)
- ユーザーコードに関するバグ修正(by さとぴあ)
- しぃペインターで動画から続きを書けないミス修正

### [2021/08/11] v0.99.0

- 続きから描くの画像差し替えが機能していなかったの修正
- パレット選択機能実装
- そのついでにパレットデータ`p_PCCS.txt`,`p_munsellHVC.txt`を作ったので同梱
- configに設定はあったトラブルシューティングを実装
- 各テーマ更新
- あとなんかたくさん更新した気がするけど忘れた

### [2021/08/10] v0.4.2b1

- いったんコミット
- 続きから描くときとアニメ再生時におかしかったの修正

### [2021/08/09] v0.4.1

- 各テーマ
  - 追加お知らせの表示がおかしいの修正
  - chickenpaintで描画時間が記録されないバグ修正
  - シェアボタンのリンクがうまく作成されないの修正

### [2021/08/09] v0.4.0

- [chickenpaint](https://github.com/thenickdude/chickenpaint)でのお絵描きに対応
- `config.php`
  - `$addinfo`を配列とし、htmlタグ`<li> </li>`で囲まれるように変更
  - 管理パスが初期値のままではスクリプトが動かないように念のため変更
  - 再設定をお願いします。
- 07/30の「データベースのサイズをあとから変えるのが困難」が解決できそうなのでこのまま行くことにした。
- 各テーマもかなり更新しております

### [2021/08/02] v0.3.0

- セキュリティ対策の改善
  - タグや特殊文字は表示するときに無効化する。
  - さとぴあさんありがとうございます。
- 改行はコードのまま保存し、表示のときにHTMLタグにするように変更
- コンフィグファイルの互換性がなくなったときは起動できないようにした
- csrfトークンを使って不正な投稿を拒絶する設定追加

### [2021/07/30] 今後

~~ - やはり「データベースのサイズをあとから変えるのが困難」ということで、ログの保存形式をjsonかなにかにしようと思った。 ~~

### [2021/07/13] v0.2.4

- v0.2.3がちょっと間違ってたので修正。

### [2021/07/12] v0.2.3

- URL欄にURLじゃないものが入っていた場合表示しないように修正。

### [2021/07/06] v0.2.2

- theme(MONORED)
  - css切り替え機能の脆弱性その他修正
  - そしたらjqueryが不要になったので削除
  - Paint画面に無意味にカラーピッカーを搭載

### [2021/06/23] themes

- NEOでアプレットフィットONのときにキャンバスサイズを拡大して、そのままOFFにすると表示が崩れるの修正。
- シェアボタンあたりとアイコン周り修正。

### [2021/06/14] v0.2.1

- テキストエリアからCtrl+Enterで送信できるようにした。
- 送信ボタンの位置修正。
- アプレットフィットの著作権を表示。

### [2021/06/13] v0.2.0

- パレットファイル(`palette.txt`)の外部化
- アプレットフィット機能実装

### [2021/06/13] theme

- ついったでシェアできないの修正。

### [2021/06/13] v0.1.2

- 動画アニメーションモードに入れないバグ修正。
- 管理モードに入れないバグ修正。

### [2021/06/05] v0.1.1

- 変数のtypo修正。

### [2021/06/05] themes

- `$addinfo`でタグが使えないの修正。

### [2021/06/05] v0.1.0

- 公開。
